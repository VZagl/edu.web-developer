# 066.1 Препроцессоры в CSS (SASS, SCSS и другие)

> Изучено в `036. Препроцессоры. SASS/SCSS/LESS`

<hr>

## [БЭМ (Блок, Элемент, Модификатор)][bem]

**Введение**

БЭМ (Блок, Элемент, Модификатор) — компонентный подход к веб-разработке. В его основе лежит принцип разделения интерфейса на независимые блоки. Он позволяет легко и быстро разрабатывать интерфейсы любой сложности и повторно использовать существующий код, избегая «Copy-Paste».

### Преимущества использования БЭМ

1. **Повторное использование кода**

   БЭМ позволяет создавать независимые блоки, которые можно использовать в разных проектах или частях интерфейса без необходимости переписывать код.

2. **Улучшенная читаемость и поддержка кода**

   Благодаря строгой структуре именования классов (`блок__элемент--модификатор`), код становится более понятным и легко поддерживаемым.

3. **Избежание конфликтов стилей**

   Именование классов в БЭМ минимизирует вероятность конфликтов между стилями, так как каждый блок изолирован.

4. **Масштабируемость**

   БЭМ упрощает добавление новых элементов или модификаций в проект, сохраняя структуру кода.

### Основные принципы БЭМ

1. #### **Блок**

   Независимая сущность, которая может быть переиспользована. Например: `menu`, `button`, `header`.

   **Особенности:**

   - Название блока характеризует смысл («что это?» — «меню»: `menu`, «кнопка»: `button`), а не состояние («какой, как выглядит?» — «красный»: `red`, «большой»: `big`).
   - Блок не должен влиять на свое окружение, т. е. блоку не следует задавать внешнюю геометрию (в виде отступов, границ, влияющих на размеры) и позиционирование.
   - В CSS по БЭМ также не рекомендуется использовать селекторы по тегам или `id`.

   **Вложенность**

   - Блоки можно вкладывать друг в друга.

   - Допустима любая вложенность блоков.

2. #### **Элемент**

   Составная часть блока, которая не может существовать отдельно. Например: `menu__item`, `button__icon`.

   **Особенности:**

   - Название элемента характеризует смысл («что это?» — «пункт»: `item`, «текст»: `text`), а не состояние («какой, как выглядит?» — «красный»: `red`, «большой»: `big`).

   - Структура полного имени элемента соответствует схеме: `имя-блока__имя-элемента`. Имя элемента отделяется от имени блока двумя подчеркиваниями (`__`).

   **Принципы работы с элементами**

   - **Вложенность**
     - Элементы можно вкладывать друг в друга.
     - Допустима любая вложенность элементов.
     - Элемент — всегда часть блока, а не другого элемента. Это означает, что в названии элементов нельзя прописывать иерархию вида `block__elem1__elem2`.
   - **Принадлежность**
     - Элемент — всегда часть блока и не должен использоваться отдельно от него.
   - **Необязательность**
     - Элемент — необязательный компонент блока. Не у всех блоков должны быть элементы.

3. #### **Модификатор**

   Определяет внешний вид, состояние или поведение блока или элемента. Например: `button--disabled`, `menu__item--active`.

   **Особенности:**

   - [Название модификатора](https://ru.bem.info/methodology/naming-convention/#имя-модификатора-блока) характеризует внешний вид («какой размер?», «какая тема?» и т. п. — «размер»: `size_s`, «тема»: `theme_islands`), состояние («чем отличается от прочих?» — «отключен»: `disabled`, «фокусированный»: `focused`) и поведение («как ведет себя?», «как взаимодействует с пользователем?» — «направление»: `directions_left-top`).

   - Имя модификатора отделяется от имени блока или элемента одним подчеркиванием (`_`).
     - _**AI Copilot** рекомендует модификатор отделять двойным минусом (`--`): `menu__item--active`, `menu--hidden`, `menu--theme_islands`._

   **Принципы работы с модификаторами**

   _**Модификатор нельзя использовать самостоятельно**_

   С точки зрения БЭМ-методологии модификатор не может использоваться в отрыве от модифицируемого блока или элемента. Модификатор должен изменять вид, поведение или состояние сущности, а не заменять ее.

#### Микс

Прием, позволяющий использовать разные БЭМ-сущности на одном DOM-узле.

Миксы позволяют:

- совмещать поведение и стили нескольких сущностей без дублирования кода;
- создавать семантически новые компоненты интерфейса на основе имеющихся.

Пример

```html
<!-- Блок `header` -->
<div class="header">
	<!-- К блоку `search-form` примиксован элемент `search-form` блока `header`-->
	<div class="search-form header__search-form"></div>
</div>
```

В данном примере мы совместили поведение и стили блока `search-form` и элемента `search-form` блока `header`. Такой подход позволяет нам задать внешнюю геометрию и позиционирование в элементе `header__search-form`, а сам блок `search-form` оставить универсальным. Таким образом, блок можно использовать в любом другом окружении, потому что он не специфицирует никакие отступы. Это позволяет нам говорить о его независимости.

### Пример использования БЭМ

```html
<div class="menu">
	<div class="menu__item menu__item--active">Главная</div>
	<div class="menu__item">О нас</div>
	<div class="menu__item">Контакты</div>
</div>
```

```css
.menu {
	display: flex;
	list-style: none;
}

.menu__item {
	cursor: pointer;
	padding: 10px;
}

.menu__item--active {
	color: red;
	font-weight: bold;
}
```

### Когда создавать блок, когда — элемент?

#### Создавайте блок

Если фрагмент кода может использоваться повторно и не зависит от реализации других компонентов страницы.

#### Создавайте элемент

Если фрагмент кода не может использоваться самостоятельно, без родительской сущности (блока).

Исключение составляют элементы, реализация которых для упрощения разработки требует разделения на более мелкие части — подэлементы. В БЭМ-методологии [нельзя создавать элементы элементов](https://ru.bem.info/methodology/quick-start/#вложенность-1). В подобном случае вместо элемента необходимо создавать служебный блок.

### Файловая структура

Принятый в методологии БЭМ компонентный подход применяется и к организации проектов в файловой структуре. Реализации блоков, элементов и модификаторов делятся на независимые файлы-технологии, что позволяет нам подключать их опционально.

**Особенности:**

- Один блок — одна директория.
- Имена блока и его директории совпадают. Например, блок `header` — директория `header/`, блок `menu` — директория `menu/`.
- Реализация блока разделяется на отдельные файлы-технологии. Например, `header.css`, `header.js`.
- Директория блока является корневой для поддиректорий соответствующих ему элементов и модификаторов.
- Имена директорий элементов начинаются с двойного подчеркивания (`__`). Например, `header/__logo/`, `menu/__item/`.
- Имена директорий модификаторов начинаются с одинарного подчеркивания (`_`). Например, `header/_fixed/`, `menu/_theme_islands/`.
  - _`AI Copilot` рекомендует использовать двойной минус (`--`)._
- Реализации элементов и модификаторов разделяются на отдельные файлы-технологии. Например, `header__input.js`, `header_theme_islands.css`.

Пример

```bash
search-form/                           # Директория блока search-form

    __input/                           # Поддиректория элемента search-form__input
        search-form__input.css         # Реализация элемента search-form__input
                                       # в технологии CSS
        search-form__input.js          # Реализация элемента search-form__input
                                       # в технологии JavaScript

    __button/                          # Поддиректория элемента search-form__button
        search-form__button.css
        search-form__button.js

    _theme/                            # Поддиректория модификатора
                                       # search-form_theme
        search-form_theme_islands.css  # Реализация блока search-form, имеющего
                                       # модификатор theme со значением islands
                                       # в технологии CSS
        search-form_theme_lite.css     # Реализация блока search-form, имеющего
                                       # модификатор theme со значением lite
                                       # в технологии CSS

    search-form.css                    # Реализация блока search-form
                                       # в технологии CSS
    search-form.js                     # Реализация блока search-form
                                       # в технологии JavaScript
```

Такая файловая структура позволяет легко поддерживать и повторно использовать код.

> Разветвленная файловая структура предполагает, что в **production** код будет собираться в общие файлы проекта.

### Инструменты для работы с БЭМ

- **CSS-препроцессоры**  
  Использование SASS/SCSS упрощает написание стилей для БЭМ, благодаря вложенности и переменным.

- **Автоматизация**  
  Инструменты, такие как PostCSS, помогают автоматизировать работу с БЭМ, например, генерировать классы или проверять соответствие методологии.

<hr>

## Ресурсы:

- [Live Sass Compiler](https://marketplace.visualstudio.com/items?itemName=glenn2223.live-sass)
- [Sass](https://sass-lang.com)
- [Настройка плагина](https://docs.google.com/document/d/1-49py1wYz4PQdmQbBdtTxmMtNLJrJby9YPfmjZbB7HY/edit?tab=t.0)
- [Ёмко про препроцессоры](https://www.geeksforgeeks.org/what-is-a-css-preprocessors/)
- [БЭМ (Блок, Элемент, Модификатор)][bem]

[bem]: https://ru.bem.info/methodology/quick-start/
